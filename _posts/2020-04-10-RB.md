---
title: 레드 블릭 트리(Red Black Tree)
categories: 
  - Data Structure & Algorithms
last_modified_at: 2020-04-06T13:00:00+09:00
use_math: true
---

레드 블랙 트리는 이진트리의 한 형태로, 이진 트리의 속성을 가져 부모노드보다 작은 값을 가지는 노드는 왼쪽 노드로, 큰 값을 가지는 노드는 오른쪾 노드에 배치되게 합니다. 레드 블랙 트리, 즉 RB 트리는 기본적으로 아래 다섯 가지 속성을 만족해야 합니다.


1. 모든 노드는 빨간색, 검은색 둘 중 하나다.
2. 루트 노드는 검은색이다.
3. 모든 잎새노드(NIL)은 검은색이다.
4. 어떤 노드가 빨간색이라면 그 자식 노드(오른쪽, 왼쪽 노드)는 모두 검은색 이다.(빨삭색 노드가 같은 경로상에 연이어 존재하지 않는다.)
5. 루트노드에서 잎새노드(NIL) 사이의 검은색 노드의 수는 모두 같다.


RB 트리의 예는 아래와 같고 위의 속성을 모두 만족하고 있는 것을 알 수 있습니다.  


![ex_screenshot](https://i.imgur.com/UKdoSm5.png)


RB 트리 노드의 높이 $h$는 해당 노드로부터 잎새노드에까지 이르는 가장 긴 경로의 엣지 수를 말합니다. 임의의 노드의 Black-Height는 $x$부터 잎새노드에 이르는 경로상에 있는 검은색 노드의 수로 $bh(x)$라고 표기합니다. $x$가 검은색 노드일 경우 1을 빼서 잎새노드(NIL)의 $bh$는 0입니다.  


![ex_screenshot](https://i.imgur.com/OslgbRe.png)


## 삽입(insert)  

RB 트리에서 삽입은 이진트리와 동일합니다. 하지만 다른 점은 새로운 노드가 삽입되더라도 기본적으로 위 5가지 속성은 유지하고 있어야 한다는 것이죠. 이 속성을 유지하기 위해서 필요한 몇가지 과정이 있습니다. 이를 이해하기 위해 2가지 Case를 통해서 알아보겠습니다.  

### case 1) 삼촌노드가 빨간색일때  

아래 그림에서 새로운 노드 z가 삽입된 경우를 한번 살펴보겠습니다. z 노드가 삽입된 후 빨간색 노드가 연이어 등장하게 되었습니다. 이것은 속성 4에 위배되게 됩니다. 이 경우 z 노드의 삼촌노드는 y이며 빨간색이면 Z 노드의 부모와 삼촌 노드의 색을 칠해주고, 부모의 부모 노드 또한 색을 바꿔주면 됩니다.  

![ex_screenshot](https://i.imgur.com/Op0h0KH.png)

 
### case 2, 3) 삼촌노드가 검은색일때  


이번에는 삼촌노드가 검은색인 두가지 case를 살펴보겠습니다. 삼촌노드 즉 y가 검은색일때 새로운 노드가 오른쪽에 삽입 된 경우입니다. 마찬가지로 빨간색 노드가 연이어 등장하기 때문에 네번째 속성에 위배됩니다. 이때 case2인 경우로 Double Rotation을 수행해줍니다. 새로운 노드가 왼쪽 노드에 삽입된 경우는 cas3으로 Single Rotation을 수행해주면 됩니다.  

![ex_screenshot](https://i.imgur.com/T63EEsx.png)


## 삭제(delete)

RB 트리에서 삭제할 때도 마찬가지로 속성에 위배되지 않도록 해야합니다. 이는 삽입과 마찬가지로 single/double rotation을 이용하여 해결할 수 있습니다. 단, 빨간색 노드를 삭제할 때는 그냥 삭제를 수행하면 됩니다.


## 시간복잡도

전체 높이를 $h$라고 할 때, 삽입, 삭제, 검색의 시간복잡도는 $O(h)$입니다. 하지만 RB 트리의 노드 수과 n이라면 높이의 상한은 $2\log_{n}+1$이기 때문에 시간복잡도는 $O(\log_{n})$입니다.

